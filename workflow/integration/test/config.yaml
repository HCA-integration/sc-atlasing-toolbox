output_dir: test/out
images: test/images

use_gpu: true
env_mode: from_yaml

resources:
  cpu:
    partition: cpu
    qos: normal
    gpu: 0
    mem_mb: 1000
  gpu:
    partition: gpu
    qos: normal
    gpu: 1
    mem_mb: 4000

defaults:
  integration:
    raw_counts: counts
    norm_counts: X
    methods:
      bbknn:
      combat:
      harmony:
      harmony_rapids:
      harmonypy:
      scanorama:
      scanvi:
        n_hidden: 128
        dispersion: gene
        max_epochs: 10
        use_observed_lib_size: true
      scgen:
        n_epochs: 10
      scpoli:
        supervised:
          - true
          - false
        model:
          embedding_dims: 5
          recon_loss: nb
        train:
          n_epochs: 50
      scvi:
        n_hidden: 128
        dispersion:
          - gene
          - gene-batch
          - gene-label
          - gene-cell
        max_epochs: 10
        use_observed_lib_size: true
      unintegrated:
  datasets:
    - test
    - test2
    - test3
    - harmony_comparison


DATASETS:
  test:
    input:
      integration: test/input/pbmc68k.h5ad
    integration:
      label: bulk_labels
      batch:
        - phase
        - batch_2

  test2:
    input:
      integration: test/input/pbmc68k.h5ad
    integration:
      label: bulk_labels
      batch: batch
      lineage: phase
      methods:
        unintegrated:
      umap_colors:
        - bulk_labels
        - phase

  test3:
    input:
      integration: test/input/preprocessing/pbmc/3bd5f9cfa3/preprocessed.zarr
    integration:
      raw_counts: raw
      norm_counts: X
      label: bulk_labels
      batch: batch
      methods:
        unintegrated:
        scgen:
          n_epochs: 10

  harmony_comparison:
    input:
      integration: test/input/pbmc68k.h5ad
    integration:
      label: bulk_labels
      batch: batch
      methods:
        harmony_rapids:
        harmonypy:
        harmony:
      umap_colors:
        - bulk_labels
        - phase
