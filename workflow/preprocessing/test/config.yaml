output_dir: test/out
dataset_meta: test/datasets.tsv
images: test/images


filter_per_organ:
  blood:
    cells_per_sample:
      min: 50
      max: 10000
    mito_pct: 30

filter_per_study:
  SchulteSchrepping2020:
    remove_by_colum:
      sample:
        - Schulte-Schrepping_C2P01H_d0
        - Schulte-Schrepping_C2P05F_d0
        - Schulte-Schrepping_C2P07H_d0
        - Schulte-Schrepping_C2P10H_d0
        - Schulte-Schrepping_C2P13F_d0
        - Schulte-Schrepping_C2P15H_d0
        - Schulte-Schrepping_C2P16H_d0
        - Schulte-Schrepping_C2P19H_d0
      donor:
        - C19-CB-0008
      disease:
        - influenza

defaults:
  preprocessing:
    assemble:
      - counts
      - normalize
      - highly_variable_genes
      - pca
      - neighbors

DATASETS:
  blood:
    input:
      preprocessing: test/input/load_data/merged/organ/blood.zarr
    preprocessing:
      batch: donor
      lineage: development_stage
      scale: true
      highly_variable_genes:
        n_top_genes: 2000
        flavor: seurat
        subset: true
      neighbors:
        n_neighbors: 15
        n_pcs: 50
  
  test:
    input:
      preprocessing: test/input/pbmc68k.h5ad
    preprocessing:
      raw_counts: counts
      scale: false
      assemble:
        - counts
        - normalize
