output_dir: test/out
dataset_meta: test/datasets.tsv
images: test/images

use_gpu: true

defaults:
  preprocessing:
    neighbors:
      n_neighbors: 15
      n_pcs: 50

DATASETS:
  blood:
    input:
      preprocessing: test/input/load_data/merged/organ/blood.zarr
    preprocessing:
      batch: donor
      lineage: development_stage
      scale: false
      highly_variable_genes:
        n_top_genes: 2000
        subset: true
      assemble:
        - counts
        - normalize
        - highly_variable_genes
        - pca
        - neighbors
      colors:
        - cell_type
        - study
        - development_stage
  
  pbmc:
    input:
      preprocessing: test/input/pbmc68k.h5ad
    preprocessing:
      raw_counts: counts
      scale: true
      highly_variable_genes:
        n_top_genes: 100
        subset: false
      assemble:
        - counts
        - normalize
        - highly_variable_genes
        - pca
        - neighbors
        - umap

  no_hvg:
    input:
      preprocessing: test/input/pbmc68k.h5ad
    preprocessing:
      raw_counts: counts
      highly_variable_genes: false
      assemble:
        - highly_variable_genes
        - pca
      colors:
        - bulk_labels
        - batch