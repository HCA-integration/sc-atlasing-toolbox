output_dir: test/out
images: test/images

use_gpu: true

resources:
  cpu:
    partition: cpu
    qos: normal
    gpu: 0
    mem_mb: 1000
  gpu:
    partition: gpu
    qos: normal
    gpu: 1
    mem_mb: 1000

defaults:
  integration:
    raw_counts: counts
    norm_counts: X
    methods:
      bbknn:
      combat:
      harmony:
      scanorama:
      scanvi:
        n_hidden: 128
        dispersion: gene
        max_epochs: 10
        use_observed_lib_size: true
      scgen:
        n_epochs: 10
      scpoli:
        supervised:
          - true
          - false
        model:
          embedding_dims: 5
          recon_loss: nb
        train:
          n_epochs: 50
      scvi:
        n_hidden: 128
        dispersion:
          - gene
          - gene-batch
          - gene-label
          - gene-cell
        max_epochs: 10
        use_observed_lib_size: true
      unintegrated:
  datasets:
    - test
    - test2

DATASETS:
  test:
    input:
      integration:
        pbmc: test/input/pbmc68k.h5ad
    integration:
      label: bulk_labels
      batch:
        - batch
        - batch2
      lineage: phase
      methods:
        unintegrated:
      umap_colors:
        - bulk_labels
        - phase

  test2:
    input:
      integration:
        pp_pbmc: test/input/preprocessing/all/pbmc/preprocessed.zarr
    clustering:
      resolutions:
        - 0.5
        - 1
    integration:
      raw_counts: raw
      norm_counts: X
      label: bulk_labels
      batch: batch
      lineage: phase
      methods:
        unintegrated:
        scgen:
          n_epochs: 10
